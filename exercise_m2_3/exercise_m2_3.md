# Exercises 1-9 from Chapter 5, Section 1

## Exercise 1
Write an INSERT statement that adds this row to the Terms table:
- **terms_id**: 6
- **terms_description**: Net due 120 days
- **terms_due_days**: 120
Use MySQL Workbench to review the column definitions for the Terms table, and include a column list with the required columns in the INSERT statement.

```sql
INSERT INTO terms (terms_id, terms_description, terms_due_days)
VALUES (6, 'Net due 120 days', 120);
```

The `INSERT INTO` statement is used to add a new row.

## Exercise 2
Write an UPDATE statement that modifies the row you just added to the Terms table. This statement should change the `terms_description` column to "Net due 125 days", and it should change the `terms_due_days` column to 125.

```sql
UPDATE terms
SET terms_description = 'Net due 125 days',
    terms_due_days = 125
WHERE terms_id = 6;
```

The `UPDATE` statement modifies existing records. The `SET` clause defines the new values for specified columns.

## Exercise 3
Write a DELETE statement that deletes the row you added to the Terms table in exercise 1.

```sql
DELETE FROM terms
WHERE terms_id = 6;
```

The `DELETE` statement removes records.

## Exercise 4
Write an INSERT statement that adds this row to the Invoices table:
- **invoice_id**: The next automatically generated ID
- **vendor_id**: 32
- **invoice_number**: AX-014-027
- **invoice_date**: 8/1/2018
- **invoice_total**: $434.58
- **payment_total**: $0.00
- **credit_total**: $0.00
- **terms_id**: 2
- **invoice_due_date**: 8/31/2018
- **payment_date**: null
Write this statement without using a column list.

```sql
INSERT INTO invoices
VALUES (NULL, 32, 'AX-014-027', '2018-08-01', 434.58, 0.00, 0.00, 2, '2018-08-31', NULL);
```

Inserting without a column list requires providing values for every column in the exact order defined in the table schema. `NULL` is passed for `invoice_id` to trigger the `AUTO_INCREMENT` feature.

## Exercise 5
Write an INSERT statement that adds these two rows to the `Invoice_Line_Items` table:
| Column | Row 1 | Row 2 |
| :--- | :--- | :--- |
| **invoice_sequence** | 1 | 2 |
| **account_number** | 160 | 527 |
| **line_item_amount** | $180.23 | $254.35 |
| **line_item_description** | Hard drive | Exchange Server update |

Set the `invoice_id` column of these two rows to the invoice ID that was generated by MySQL for the invoice you added in exercise 4.

```sql
INSERT INTO invoice_line_items (invoice_id, invoice_sequence, account_number, line_item_amount, line_item_description)
VALUES
(LAST_INSERT_ID(), 1, 160, 180.23, 'Hard drive'),
(LAST_INSERT_ID(), 2, 527, 254.35, 'Exchange Server update');
```

`LAST_INSERT_ID()` retrieves the auto-generated primary key from the most recent `INSERT` statement (the one from Exercise 4). Multiple value sets separated by a comma allow inserting multiple rows in a single statement.

## Exercise 6
Write an UPDATE statement that modifies the invoice you added in exercise 4. This statement should change the `credit_total` column so it’s 10% of the `invoice_total` column, and it should change the `payment_total` column so the sum of the `payment_total` and `credit_total` columns are equal to the `invoice_total` column.

```sql
UPDATE invoices
SET credit_total = invoice_total * 0.1,
    payment_total = invoice_total - (invoice_total * 0.1)
WHERE invoice_id = LAST_INSERT_ID();
```

The calculations `invoice_total * 0.1` and `invoice_total - (invoice_total * 0.1)` are performed using the current values in the row. `LAST_INSERT_ID()` targets the specific invoice created in the session.

## Exercise 7
Write an UPDATE statement that modifies the `Vendors` table. Change the `default_account_number` column to 403 for the vendor with an ID of 44.

```sql
UPDATE vendors
SET default_account_number = 403
WHERE vendor_id = 44;
```

## Exercise 8
Write an UPDATE statement that modifies the `Invoices` table. Change the `terms_id` column to 2 for each invoice that’s for a vendor with a `default_terms_id` of 2.

```sql
UPDATE invoices
SET terms_id = 2
WHERE vendor_id IN (
    SELECT vendor_id
    FROM vendors
    WHERE default_terms_id = 2
);
```

A subquery identifies all `vendor_id`s where the `default_terms_id` is 2. The main `UPDATE` statement then applies the change to all invoices linked to those vendors.

Here is a short summary of the MySQL **IN** operator in Markdown.

> The `IN` operator allows you to specify **multiple values** in a `WHERE` clause. It checks if a column's value matches **any** value in a given list.

1. **Shorthand for OR:** It is a cleaner way to write multiple `OR` conditions.
2. **Readability:** It makes your SQL queries shorter and easier to read.
3. **Subqueries:** It is frequently used with **Subqueries** to filter data based on results from another table.

| Logic | SQL Syntax |
| --- | --- |
| **Using OR (Long)** | `WHERE ID = 1 OR ID = 2 OR ID = 3` |
| **Using IN (Short)** | `WHERE ID IN (1, 2, 3)` |

## Exercise 9
Write a DELETE statement that deletes the row that you added to the `Invoices` table in exercise 4. When you execute this statement, it will produce an error since the invoice has related rows in the `Invoice_Line_Items` table. To fix that, precede the DELETE statement with another DELETE statement that deletes the line items for this invoice. (Remember that to code two or more statements in a script, you must end each statement with a semicolon.)

```sql
DELETE FROM invoice_line_items
WHERE invoice_id = LAST_INSERT_ID();

DELETE FROM invoices
WHERE invoice_id = LAST_INSERT_ID();
```

Referential integrity constraints (foreign keys) prevent deleting a parent record (`invoices`) while child records (`invoice_line_items`) exist. The child records must be deleted first. `LAST_INSERT_ID()` is used again to target the same invoice.
